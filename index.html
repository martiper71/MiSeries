<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MisSeries</title>
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6366f1">
    <link rel="apple-touch-icon" href="icono.png">
    <link rel="icon" type="image/png" href="icono.png">
    <link rel="shortcut icon" href="icono.png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- Pantalla de Inicio (Login / Registro / Reset) -->
    <div id="loginOverlay">
        <!-- Pantalla 1: LOGIN -->
        <div id="cardLogin" class="auth-card">
            <h2>IdentifÃ­cate</h2>
            <div class="login-field">
                <input type="email" id="emailInput" placeholder="Tu Email">
            </div>
            <div class="login-field">
                <input type="password" id="passInput" placeholder="Tu ContraseÃ±a">
            </div>
            <button class="btn-entrar" id="btnLogin" onclick="login()">Entrar</button>
            <div id="loginLoading" class="login-loading hidden">
                <div class="spinner"></div>
                <span>Verificando credenciales...</span>
            </div>
            <div class="login-links">
                <p>Â¿No tienes cuenta? <a href="javascript:void(0)"
                        onclick="mostrarPantalla('cardRegistro')">RegÃ­strate</a></p>
                <p><a href="javascript:void(0)" onclick="mostrarPantalla('cardReset')">Â¿Olvidaste tu contraseÃ±a?</a></p>
            </div>
        </div>

        <!-- Pantalla 2: REGISTRO -->
        <div id="cardRegistro" class="auth-card hidden">
            <h2>RegÃ­strate</h2>
            <div class="login-field">
                <input type="email" id="regEmail" placeholder="Tu Email">
            </div>
            <div class="login-field">
                <input type="password" id="regPass" placeholder="Tu ContraseÃ±a">
            </div>
            <div class="login-field">
                <input type="password" id="regPassConfirm" placeholder="Repite ContraseÃ±a">
            </div>
            <button class="btn-entrar" id="btnRegistro" onclick="registrarUsuario()">Crear cuenta</button>
            <div id="regLoading" class="login-loading hidden">
                <div class="spinner"></div>
                <span>Creando tu espacio...</span>
            </div>
            <div class="login-links">
                <p>Â¿Ya tienes cuenta? <a href="javascript:void(0)" onclick="mostrarPantalla('cardLogin')">Inicia
                        sesiÃ³n</a></p>
            </div>
        </div>

        <!-- Pantalla 3: RECOBRAR CONTRASEÃ‘A -->
        <div id="cardReset" class="auth-card hidden">
            <h2>Recuperar</h2>
            <p style="color: #64748b; margin-bottom: 20px;">Te enviaremos un email para restablecer tu acceso.</p>
            <div class="login-field">
                <input type="email" id="resetEmail" placeholder="Tu Email">
            </div>
            <button class="btn-entrar" onclick="solicitarReseteo()">Enviar enlace</button>
            <div class="login-links">
                <p><a href="javascript:void(0)" onclick="mostrarPantalla('cardLogin')">Volver al inicio</a></p>
            </div>
        </div>
    </div>


    <button class="btn-logout" onclick="logout()">
        <span>ğŸšª</span> Cerrar sesiÃ³n
    </button>

    <!-- Aviso de ActualizaciÃ³n PWA -->
    <div id="updateBanner" class="update-banner hidden">
        <span>âœ¨ Nueva versiÃ³n disponible</span>
        <button onclick="window.location.reload(true)">Actualizar ahora</button>
    </div>

    <h1>ğŸ“º MisSeries</h1>

    <!-- SecciÃ³n de EstadÃ­sticas -->
    <div id="statsContainer" class="stats-container hidden">
        <div class="stats-grid">
            <div class="stat-item">
                <span class="stat-value" id="statSeries">0</span>
                <span class="stat-label">Series</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="statEpisodios">0</span>
                <span class="stat-label">Episodios vistos</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="statVistas">0</span>
                <span class="stat-label">Completadas</span>
            </div>
        </div>
        <div id="statsMessage" class="stats-message"></div>
    </div>

    <div class="search-container">
        <input type="text" id="searchInput" placeholder="Buscar o aÃ±adir una serie">
        <button onclick="buscarSeries()">Buscar</button>
    </div>

    <div id="searchResultsSection" class="hidden">
        <h2 class="section-title">ğŸ” Resultados de bÃºsqueda</h2>
        <div id="results" class="results-grid" style="margin-bottom: 50px;"></div>
    </div>

    <div id="coleccionSecciones">
        <div id="sectionPendiente" class="hidden">
            <h2 class="section-title pendiente">â³ Pendientes</h2>
            <div id="gridPendiente" class="results-grid"></div>
        </div>

        <div id="sectionViendo" class="hidden">
            <h2 class="section-title viendo">ğŸ“º Viendo</h2>
            <div id="gridViendo" class="results-grid"></div>
        </div>

        <div id="sectionAlDia" class="hidden">
            <h2 class="section-title aldia">ğŸ‘ Al dÃ­a</h2>
            <div id="gridAlDia" class="results-grid"></div>
        </div>

        <div id="sectionVista" class="hidden">
            <h2 class="section-title vista">âœ… Vistas</h2>
            <div id="gridVista" class="results-grid"></div>
        </div>
    </div>

    <!-- Vista de Detalle -->
    <div id="detailView" class="detail-view">
        <div class="detail-content-container">
            <button class="back-btn" onclick="cerrarDetalle()" title="Cerrar">âœ•</button>
            <div id="detailBody" class="detail-content">
                <!-- Se llena dinÃ¡micamente -->
            </div>
        </div>
    </div>

    <!-- Modal Serie Finalizada -->
    <div id="finishModal">
        <div class="finish-card">
            <h2>ğŸ† Â¡Serie Finalizada!</h2>
            <p>Â¿QuÃ© te ha parecido? PuntÃºala y aÃ±ade tus notas finales.</p>

            <div class="stars-container" id="starsContainer">
                <span class="star" data-value="1">â˜…</span>
                <span class="star" data-value="2">â˜…</span>
                <span class="star" data-value="3">â˜…</span>
                <span class="star" data-value="4">â˜…</span>
                <span class="star" data-value="5">â˜…</span>
            </div>

            <textarea class="notes-area" id="finishNotes"
                placeholder="AÃ±ade tus comentarios sobre la serie..."></textarea>

            <button class="btn-entrar btn-finish-save" onclick="guardarFinalizacion()">Guardar y finalizar</button>
            <button class="btn-secundario" style="width: 100%;" onclick="cerrarFinishModal()">Cerrar sin
                guardar</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pocketbase/0.21.1/pocketbase.umd.js"></script>
    <script src="config.js"></script>
    <script src="app.js"></script>

</body>

</html>